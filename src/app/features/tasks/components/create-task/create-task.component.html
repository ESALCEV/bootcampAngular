<h1>Create Task</h1>
<form [formGroup]="taskForm" (ngSubmit)="onSubmit()">
   <div class="form-row">
    <label for="title">Task Title</label>
    <input id="title" type="text" formControlName="title">

    <div class="error-container">
      @if (title?.invalid && title?.touched){
        @if (title?.hasError('required')) {
          <div class="error-msg">
            Title is required.
          </div>
        }
        @if(title?.hasError('minlength')) {
          <div class="error-msg">
            Title must be at least 3 characters long.
          </div>
        }
      }
    </div>
  </div>

  <div class="form-row">
    <label for="description">Description</label>
    <textarea id="description" formControlName="description"></textarea>
  </div>

  <div class="form-row">
        <label for="type">Type</label>
        <select name="type" id="type" formControlName="type">
            <option value="">Select Task Type</option>

            @for (type of types; track type.value) {
                <option [value]="type.value">{{ type.viewValue }}</option>
            }
        </select>
        <div class="error-container">
            @if (type?.invalid && type?.touched){
                <div class="error-msg">
                    Type is required
                </div>
            }
        </div>
    </div>

  <div class="form-row">
    <label for="status">Status</label>
    <select id="status" formControlName="status">
        <option value="">Select a Status</option>
        @for (status of statuses; track status.value) {
            <option [value]="status.value">{{ status.viewValue }}</option>
        }
    </select>
    <div class="error-container">
            @if (status?.invalid && status?.touched){
                <div class="error-msg">
                    Status is required
                </div>
            }
        </div> 
  </div>

  <div class="form-row">
    <label for="assignedTo">Assigned To</label>
    <select id="assignedTo" formControlName="assignedTo">
        <option value="UNASSIGNED">Unassigned</option>
        @for (user of usersStore.users(); track user.id) {
            <option [value]="user.id">{{ user.firstName }} {{ user.lastName }} ({{ user.username }})</option>
        }
    </select>
  </div>

  <button class="create-task-btn" type="submit" [disabled]="creating$ | async">Create Task</button>
</form>